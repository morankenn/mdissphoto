<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:pretty="http://ocpsoft.com/prettyfaces"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">  
    
    <ui:composition template="/faces/app/self-space.xhtml">
      
	<ui:define name="body">
					<div class="row" id="notifications">
						<div class="span6">
						<h1>Notifications</h1>
						<div class=" alert-normal alert alert-padding">
							<ui:repeat value="#{dashboardBean.notifications}" var="notification">
							  	<h:panelGroup layout="block" rendered="#{notification['class'].simpleName == 'PhotoUploadedNotification'}" 
							  					styleClass="alert alert-info notification-alert">
							  	
							  		<div class="row-fluid">
							  			<div class="span3">
											<img src="http://www.dummyimage.com/100x100"></img>
										</div>
							  			<div class="span9">
								  			<div class="row-fluid">
										  		<div class="span12 notification-date">
								  					<em>#{notification.date}</em>
								  				</div>
								  			</div>
								  			<div class="row-fluid">
								  				<div class="span10">
									  				<h3>
										  				<pretty:link mappingId="user-profile" >
															<f:param value="#{notification.uploaderUsername}" /><strong>#{notification.uploaderUsername}</strong>
														</pretty:link> uploaded a new 
														<pretty:link mappingId="photo-detail" >
															<f:param value="#{notification.uploaderUsername}" />
															<f:param value="#{notification.photoId}" /><strong>photo</strong>
														</pretty:link>!
													</h3>
												</div>
									  			<div class="span2">
									  				<h:graphicImage value="/dynamic/image?db=#{dashboardBean.thumbnailDatabase}&amp;bucket=#{dashboardBean.thumbnailBucket}&amp;id=#{notification.photoId}"/>
									  			</div>
								  			</div>
							  			</div>
							  		</div>
							  	</h:panelGroup>
							    <h:panelGroup layout="block" rendered="#{notification['class'].simpleName == 'FollowingNotification'}" 
							  					styleClass="alert alert-success notification-alert">
							  	
								  	<div class="row-fluid">
									  	<div class="span3">
											<img src="http://www.dummyimage.com/100x100"></img>
										</div>
										<div class="span9">
											<div class="row-fluid">
									  			<div class="span12 notification-date">
													<em class="">#{notification.date}</em>
												</div>
											</div>
											<div class="row-fluid">
												<div class="span9">
													<h3>
														<pretty:link mappingId="user-profile" >
															<f:param value="#{notification.followerUserName}" /><strong>#{notification.followerUserName}</strong>
														</pretty:link> is now following you!
													</h3>
												</div>
												<div class="span1">
													<h:form>
														<h:commandButton styleClass="btn btn-success"
																rendered="#{!dashboardBean.followsUser(dashboardBean.users[notification.followerUserName])}"
																actionListener="#{dashboardBean.addFollow(dashboardBean.users[notification.followerUserName])}" value="Follow"
																update="growl" />
														<h:commandButton styleClass="btn btn-warning"
																rendered="#{userBean.followsUser(dashboardBean.users[notification.followerUserName])}"
																actionListener="#{dashboardBean.deleteFollow(dashboardBean.users[notification.followerUserName])}"
																value="Unfollow" update="growl" />
													</h:form>
												</div>
											</div>
										</div>
								  	</div>
							  	</h:panelGroup>
							</ui:repeat>
						</div>
						</div>
						<div class="span4 offset1">
							<div class="row-fluid alert alert-normal">
								<div class="span4">
									<img src="http://www.dummyimage.com/100x100"></img>
								</div>
								<div class="span7">
									<h2>#{dashboardBean.user}</h2>
									<h3>#{dashboardBean.userObject.name} #{dashboardBean.userObject.surname}</h3>
									<div>
										Followers: #{fn:length(userObect.followers)} 
										Following: #{fn:length(userObect.follows)}
									</div>
								</div>
							</div>	
							
							<div class="row-fluid">
								<div class="span12">
									<h1>Albums</h1>
									<div class="alert-normal alert alert-padding">
										<ul class="album-list">
											<ui:repeat value="#{dashboardBean.albums}" var="album">
												<li> 
													<i class="icon-folder-open"></i> 
													<pretty:link mappingId="album-detail" >
														<f:param value="#{album.userNick}" />
														<f:param value="#{album.albumId}" />
														<strong>#{album.title} (#{fn:length(album.photos)})</strong>
													</pretty:link>
												</li>
											</ui:repeat>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
	</ui:define>
				
    </ui:composition>
</html>
